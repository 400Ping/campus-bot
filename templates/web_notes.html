{% extends "base.html" %}
{% block content %}
<div class="section-header">
  <div>
    <p class="pill tag">筆記管理</p>
    <h2 style="margin-top:6px;">把上課重點同步到 LINE + 網站</h2>
    <p class="muted" style="margin:6px 0 0;">傳 LINE 指令 <code>/note</code> 也能新增筆記，這裡提供更長篇的輸入介面。</p>
  </div>
  <a class="btn secondary" href="/web/notes">僅檢視</a>
</div>

<div class="spacer"></div>

<section class="card">
  <h3>新增筆記</h3>
  <form method="post" action="{{ url_for('web_notes_add') }}">
    <input type="hidden" name="user" value="{{ user_id }}">
    <label>課程名稱（可留空）</label>
    <input name="course_name" type="text" placeholder="例如：離散數學">
    <label>筆記內容</label>
    <textarea name="content" rows="5" placeholder="輸入課堂重點..."></textarea>
    <div class="section-header">
      <button type="submit">新增筆記（含 AI 重點）</button>
      <p class="muted">AI 會自動產生 3~5 個重點摘要。</p>
    </div>
  </form>
</section>

<div class="spacer"></div>

<h3>近期筆記</h3>
{% if notes %}
  <ul class="notes">
  {% for n in notes %}
    <li class="card note-card">
      <div class="section-header" style="align-items:flex-start; gap:10px;">
        <div>
          <a href="{{ url_for('web_note_detail', note_id=n['id']) }}"><strong>{{ n['course_name'] or 'General' }}</strong></a>
          <div class="muted" style="font-size:13px;margin-top:2px;">{{ n['ts'] }}</div>
        </div>
        <div style="margin-left:auto;">
          <form method="post" action="{{ url_for('web_note_delete', note_id=n['id']) }}" onsubmit="return confirm('確定要刪除這筆筆記？');">
            <button class="btn danger" type="submit" style="padding:6px 10px;font-size:13px;">刪除</button>
          </form>
        </div>
      </div>
      <div class="note-content">{{ n['content'] }}</div>
      <div class="note-summary muted">點進去查看今天的回顧摘要。</div>
    </li>
  {% endfor %}
  </ul>
{% else %}
  <p class="muted">尚無筆記，先在上方表單新增吧！</p>
{% endif %}
{% endblock %}
